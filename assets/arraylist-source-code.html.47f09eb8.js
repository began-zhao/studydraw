import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e}from"./app.a97696a9.js";const t={},p=e(`<h2 id="_1-arraylist-\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#_1-arraylist-\u7B80\u4ECB" aria-hidden="true">#</a> 1. ArrayList \u7B80\u4ECB</h2><p><code>ArrayList</code> \u7684\u5E95\u5C42\u662F\u6570\u7EC4\u961F\u5217\uFF0C\u76F8\u5F53\u4E8E\u52A8\u6001\u6570\u7EC4\u3002\u4E0E Java \u4E2D\u7684\u6570\u7EC4\u76F8\u6BD4\uFF0C\u5B83\u7684\u5BB9\u91CF\u80FD\u52A8\u6001\u589E\u957F\u3002\u5728\u6DFB\u52A0\u5927\u91CF\u5143\u7D20\u524D\uFF0C\u5E94\u7528\u7A0B\u5E8F\u53EF\u4EE5\u4F7F\u7528<code>ensureCapacity</code>\u64CD\u4F5C\u6765\u589E\u52A0 <code>ArrayList</code> \u5B9E\u4F8B\u7684\u5BB9\u91CF\u3002\u8FD9\u53EF\u4EE5\u51CF\u5C11\u9012\u589E\u5F0F\u518D\u5206\u914D\u7684\u6570\u91CF\u3002</p><p><code>ArrayList</code>\u7EE7\u627F\u4E8E <strong><code>AbstractList</code></strong> \uFF0C\u5B9E\u73B0\u4E86 <strong><code>List</code></strong>, <strong><code>RandomAccess</code></strong>, <strong><code>Cloneable</code></strong>, <strong><code>java.io.Serializable</code></strong> \u8FD9\u4E9B\u63A5\u53E3\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span>
        <span class="token keyword">implements</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">RandomAccess</span><span class="token punctuation">,</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span><span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>RandomAccess</code> \u662F\u4E00\u4E2A\u6807\u5FD7\u63A5\u53E3\uFF0C\u8868\u660E\u5B9E\u73B0\u8FD9\u4E2A\u8FD9\u4E2A\u63A5\u53E3\u7684 List \u96C6\u5408\u662F\u652F\u6301<strong>\u5FEB\u901F\u968F\u673A\u8BBF\u95EE</strong>\u7684\u3002\u5728 <code>ArrayList</code> \u4E2D\uFF0C\u6211\u4EEC\u5373\u53EF\u4EE5\u901A\u8FC7\u5143\u7D20\u7684\u5E8F\u53F7\u5FEB\u901F\u83B7\u53D6\u5143\u7D20\u5BF9\u8C61\uFF0C\u8FD9\u5C31\u662F\u5FEB\u901F\u968F\u673A\u8BBF\u95EE\u3002</li><li><code>ArrayList</code> \u5B9E\u73B0\u4E86 <strong><code>Cloneable</code> \u63A5\u53E3</strong> \uFF0C\u5373\u8986\u76D6\u4E86\u51FD\u6570<code>clone()</code>\uFF0C\u80FD\u88AB\u514B\u9686\u3002</li><li><code>ArrayList</code> \u5B9E\u73B0\u4E86 <code>java.io.Serializable</code>\u63A5\u53E3\uFF0C\u8FD9\u610F\u5473\u7740<code>ArrayList</code>\u652F\u6301\u5E8F\u5217\u5316\uFF0C\u80FD\u901A\u8FC7\u5E8F\u5217\u5316\u53BB\u4F20\u8F93\u3002</li></ul><h3 id="_1-1-arraylist-\u548C-vector-\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_1-1-arraylist-\u548C-vector-\u7684\u533A\u522B" aria-hidden="true">#</a> 1.1. Arraylist \u548C Vector \u7684\u533A\u522B?</h3><ol><li><code>ArrayList</code> \u662F <code>List</code> \u7684\u4E3B\u8981\u5B9E\u73B0\u7C7B\uFF0C\u5E95\u5C42\u4F7F\u7528 <code>Object[ ]</code>\u5B58\u50A8\uFF0C\u9002\u7528\u4E8E\u9891\u7E41\u7684\u67E5\u627E\u5DE5\u4F5C\uFF0C\u7EBF\u7A0B\u4E0D\u5B89\u5168 \uFF1B</li><li><code>Vector</code> \u662F <code>List</code> \u7684\u53E4\u8001\u5B9E\u73B0\u7C7B\uFF0C\u5E95\u5C42\u4F7F\u7528 <code>Object[ ]</code>\u5B58\u50A8\uFF0C\u7EBF\u7A0B\u5B89\u5168\u7684\u3002</li></ol><h3 id="_1-2-arraylist-\u4E0E-linkedlist-\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_1-2-arraylist-\u4E0E-linkedlist-\u533A\u522B" aria-hidden="true">#</a> 1.2. Arraylist \u4E0E LinkedList \u533A\u522B?</h3><ol><li><strong>\u662F\u5426\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\uFF1A</strong> <code>ArrayList</code> \u548C <code>LinkedList</code> \u90FD\u662F\u4E0D\u540C\u6B65\u7684\uFF0C\u4E5F\u5C31\u662F\u4E0D\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\uFF1B</li><li><strong>\u5E95\u5C42\u6570\u636E\u7ED3\u6784\uFF1A</strong> <code>Arraylist</code> \u5E95\u5C42\u4F7F\u7528\u7684\u662F <strong><code>Object</code> \u6570\u7EC4</strong>\uFF1B<code>LinkedList</code> \u5E95\u5C42\u4F7F\u7528\u7684\u662F <strong>\u53CC\u5411\u94FE\u8868</strong> \u6570\u636E\u7ED3\u6784\uFF08JDK1.6 \u4E4B\u524D\u4E3A\u5FAA\u73AF\u94FE\u8868\uFF0CJDK1.7 \u53D6\u6D88\u4E86\u5FAA\u73AF\u3002\u6CE8\u610F\u53CC\u5411\u94FE\u8868\u548C\u53CC\u5411\u5FAA\u73AF\u94FE\u8868\u7684\u533A\u522B\uFF0C\u4E0B\u9762\u6709\u4ECB\u7ECD\u5230\uFF01\uFF09</li><li><strong>\u63D2\u5165\u548C\u5220\u9664\u662F\u5426\u53D7\u5143\u7D20\u4F4D\u7F6E\u7684\u5F71\u54CD\uFF1A</strong> \u2460 <strong><code>ArrayList</code> \u91C7\u7528\u6570\u7EC4\u5B58\u50A8\uFF0C\u6240\u4EE5\u63D2\u5165\u548C\u5220\u9664\u5143\u7D20\u7684\u65F6\u95F4\u590D\u6742\u5EA6\u53D7\u5143\u7D20\u4F4D\u7F6E\u7684\u5F71\u54CD\u3002</strong> \u6BD4\u5982\uFF1A\u6267\u884C<code>add(E e)</code>\u65B9\u6CD5\u7684\u65F6\u5019\uFF0C <code>ArrayList</code> \u4F1A\u9ED8\u8BA4\u5728\u5C06\u6307\u5B9A\u7684\u5143\u7D20\u8FFD\u52A0\u5230\u6B64\u5217\u8868\u7684\u672B\u5C3E\uFF0C\u8FD9\u79CD\u60C5\u51B5\u65F6\u95F4\u590D\u6742\u5EA6\u5C31\u662F O(1)\u3002\u4F46\u662F\u5982\u679C\u8981\u5728\u6307\u5B9A\u4F4D\u7F6E i \u63D2\u5165\u548C\u5220\u9664\u5143\u7D20\u7684\u8BDD\uFF08<code>add(int index, E element)</code>\uFF09\u65F6\u95F4\u590D\u6742\u5EA6\u5C31\u4E3A O(n-i)\u3002\u56E0\u4E3A\u5728\u8FDB\u884C\u4E0A\u8FF0\u64CD\u4F5C\u7684\u65F6\u5019\u96C6\u5408\u4E2D\u7B2C i \u548C\u7B2C i \u4E2A\u5143\u7D20\u4E4B\u540E\u7684(n-i)\u4E2A\u5143\u7D20\u90FD\u8981\u6267\u884C\u5411\u540E\u4F4D/\u5411\u524D\u79FB\u4E00\u4F4D\u7684\u64CD\u4F5C\u3002 \u2461 <strong><code>LinkedList</code> \u91C7\u7528\u94FE\u8868\u5B58\u50A8\uFF0C\u6240\u4EE5\u5BF9\u4E8E<code>add(E e)</code>\u65B9\u6CD5\u7684\u63D2\u5165\uFF0C\u5220\u9664\u5143\u7D20\u65F6\u95F4\u590D\u6742\u5EA6\u4E0D\u53D7\u5143\u7D20\u4F4D\u7F6E\u7684\u5F71\u54CD\uFF0C\u8FD1\u4F3C O(1)\uFF0C\u5982\u679C\u662F\u8981\u5728\u6307\u5B9A\u4F4D\u7F6E<code>i</code>\u63D2\u5165\u548C\u5220\u9664\u5143\u7D20\u7684\u8BDD\uFF08<code>(add(int index, E element)</code>\uFF09 \u65F6\u95F4\u590D\u6742\u5EA6\u8FD1\u4F3C\u4E3A<code>o(n))</code>\u56E0\u4E3A\u9700\u8981\u5148\u79FB\u52A8\u5230\u6307\u5B9A\u4F4D\u7F6E\u518D\u63D2\u5165\u3002</strong></li><li><strong>\u662F\u5426\u652F\u6301\u5FEB\u901F\u968F\u673A\u8BBF\u95EE\uFF1A</strong> <code>LinkedList</code> \u4E0D\u652F\u6301\u9AD8\u6548\u7684\u968F\u673A\u5143\u7D20\u8BBF\u95EE\uFF0C\u800C <code>ArrayList</code> \u652F\u6301\u3002\u5FEB\u901F\u968F\u673A\u8BBF\u95EE\u5C31\u662F\u901A\u8FC7\u5143\u7D20\u7684\u5E8F\u53F7\u5FEB\u901F\u83B7\u53D6\u5143\u7D20\u5BF9\u8C61(\u5BF9\u5E94\u4E8E<code>get(int index)</code>\u65B9\u6CD5)\u3002</li><li><strong>\u5185\u5B58\u7A7A\u95F4\u5360\u7528\uFF1A</strong> <code>ArrayList</code> \u7684\u7A7A \u95F4\u6D6A\u8D39\u4E3B\u8981\u4F53\u73B0\u5728\u5728 list \u5217\u8868\u7684\u7ED3\u5C3E\u4F1A\u9884\u7559\u4E00\u5B9A\u7684\u5BB9\u91CF\u7A7A\u95F4\uFF0C\u800C <code>LinkedList</code> \u7684\u7A7A\u95F4\u82B1\u8D39\u5219\u4F53\u73B0\u5728\u5B83\u7684\u6BCF\u4E00\u4E2A\u5143\u7D20\u90FD\u9700\u8981\u6D88\u8017\u6BD4 <code>ArrayList</code> \u66F4\u591A\u7684\u7A7A\u95F4\uFF08\u56E0\u4E3A\u8981\u5B58\u653E\u76F4\u63A5\u540E\u7EE7\u548C\u76F4\u63A5\u524D\u9A71\u4EE5\u53CA\u6570\u636E\uFF09\u3002</li></ol><h2 id="_2-arraylist-\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB" tabindex="-1"><a class="header-anchor" href="#_2-arraylist-\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB" aria-hidden="true">#</a> 2. ArrayList \u6838\u5FC3\u6E90\u7801\u89E3\u8BFB</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span><span class="token class-name">Consumer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span><span class="token class-name">Predicate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span><span class="token class-name">UnaryOperator</span></span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span>
        <span class="token keyword">implements</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">RandomAccess</span><span class="token punctuation">,</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">8683452581122892189L</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u9ED8\u8BA4\u521D\u59CB\u5BB9\u91CF\u5927\u5C0F
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_CAPACITY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u7A7A\u6570\u7EC4\uFF08\u7528\u4E8E\u7A7A\u5B9E\u4F8B\uFF09\u3002
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> EMPTY_ELEMENTDATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

     <span class="token comment">//\u7528\u4E8E\u9ED8\u8BA4\u5927\u5C0F\u7A7A\u5B9E\u4F8B\u7684\u5171\u4EAB\u7A7A\u6570\u7EC4\u5B9E\u4F8B\u3002</span>
      <span class="token comment">//\u6211\u4EEC\u628A\u5B83\u4ECEEMPTY_ELEMENTDATA\u6570\u7EC4\u4E2D\u533A\u5206\u51FA\u6765\uFF0C\u4EE5\u77E5\u9053\u5728\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u5143\u7D20\u65F6\u5BB9\u91CF\u9700\u8981\u589E\u52A0\u591A\u5C11\u3002</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u4FDD\u5B58ArrayList\u6570\u636E\u7684\u6570\u7EC4
     */</span>
    <span class="token keyword">transient</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span> <span class="token comment">// non-private to simplify nested class access</span>

    <span class="token doc-comment comment">/**
     * ArrayList \u6240\u5305\u542B\u7684\u5143\u7D20\u4E2A\u6570
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u5E26\u521D\u59CB\u5BB9\u91CF\u53C2\u6570\u7684\u6784\u9020\u51FD\u6570\uFF08\u7528\u6237\u53EF\u4EE5\u5728\u521B\u5EFAArrayList\u5BF9\u8C61\u65F6\u81EA\u5DF1\u6307\u5B9A\u96C6\u5408\u7684\u521D\u59CB\u5927\u5C0F\uFF09
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u5982\u679C\u4F20\u5165\u7684\u53C2\u6570\u5927\u4E8E0\uFF0C\u521B\u5EFAinitialCapacity\u5927\u5C0F\u7684\u6570\u7EC4</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>initialCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u5982\u679C\u4F20\u5165\u7684\u53C2\u6570\u7B49\u4E8E0\uFF0C\u521B\u5EFA\u7A7A\u6570\u7EC4</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u5176\u4ED6\u60C5\u51B5\uFF0C\u629B\u51FA\u5F02\u5E38</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Illegal Capacity: &quot;</span><span class="token operator">+</span>
                                               initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *\u9ED8\u8BA4\u65E0\u53C2\u6784\u9020\u51FD\u6570
     *DEFAULTCAPACITY_EMPTY_ELEMENTDATA \u4E3A0.\u521D\u59CB\u5316\u4E3A10\uFF0C\u4E5F\u5C31\u662F\u8BF4\u521D\u59CB\u5176\u5B9E\u662F\u7A7A\u6570\u7EC4 \u5F53\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u5143\u7D20\u7684\u65F6\u5019\u6570\u7EC4\u5BB9\u91CF\u624D\u53D8\u621010
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u6784\u9020\u4E00\u4E2A\u5305\u542B\u6307\u5B9A\u96C6\u5408\u7684\u5143\u7D20\u7684\u5217\u8868\uFF0C\u6309\u7167\u5B83\u4EEC\u7531\u96C6\u5408\u7684\u8FED\u4EE3\u5668\u8FD4\u56DE\u7684\u987A\u5E8F\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5C06\u6307\u5B9A\u96C6\u5408\u8F6C\u6362\u4E3A\u6570\u7EC4</span>
        elementData <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5982\u679CelementData\u6570\u7EC4\u7684\u957F\u5EA6\u4E0D\u4E3A0</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u5982\u679CelementData\u4E0D\u662FObject\u7C7B\u578B\u6570\u636E\uFF08c.toArray\u53EF\u80FD\u8FD4\u56DE\u7684\u4E0D\u662FObject\u7C7B\u578B\u7684\u6570\u7EC4\u6240\u4EE5\u52A0\u4E0A\u4E0B\u9762\u7684\u8BED\u53E5\u7528\u4E8E\u5224\u65AD\uFF09</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token comment">//\u5C06\u539F\u6765\u4E0D\u662FObject\u7C7B\u578B\u7684elementData\u6570\u7EC4\u7684\u5185\u5BB9\uFF0C\u8D4B\u503C\u7ED9\u65B0\u7684Object\u7C7B\u578B\u7684elementData\u6570\u7EC4</span>
                elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u5176\u4ED6\u60C5\u51B5\uFF0C\u7528\u7A7A\u6570\u7EC4\u4EE3\u66FF</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4FEE\u6539\u8FD9\u4E2AArrayList\u5B9E\u4F8B\u7684\u5BB9\u91CF\u662F\u5217\u8868\u7684\u5F53\u524D\u5927\u5C0F\u3002 \u5E94\u7528\u7A0B\u5E8F\u53EF\u4EE5\u4F7F\u7528\u6B64\u64CD\u4F5C\u6765\u6700\u5C0F\u5316ArrayList\u5B9E\u4F8B\u7684\u5B58\u50A8\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">trimToSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">&lt;</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elementData <span class="token operator">=</span> <span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
              <span class="token operator">?</span> EMPTY_ELEMENTDATA
              <span class="token operator">:</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token comment">//\u4E0B\u9762\u662FArrayList\u7684\u6269\u5BB9\u673A\u5236</span>
<span class="token comment">//ArrayList\u7684\u6269\u5BB9\u673A\u5236\u63D0\u9AD8\u4E86\u6027\u80FD\uFF0C\u5982\u679C\u6BCF\u6B21\u53EA\u6269\u5145\u4E00\u4E2A\uFF0C</span>
<span class="token comment">//\u90A3\u4E48\u9891\u7E41\u7684\u63D2\u5165\u4F1A\u5BFC\u81F4\u9891\u7E41\u7684\u62F7\u8D1D\uFF0C\u964D\u4F4E\u6027\u80FD\uFF0C\u800CArrayList\u7684\u6269\u5BB9\u673A\u5236\u907F\u514D\u4E86\u8FD9\u79CD\u60C5\u51B5\u3002</span>
    <span class="token doc-comment comment">/**
     * \u5982\u6709\u5FC5\u8981\uFF0C\u589E\u52A0\u6B64ArrayList\u5B9E\u4F8B\u7684\u5BB9\u91CF\uFF0C\u4EE5\u786E\u4FDD\u5B83\u81F3\u5C11\u80FD\u5BB9\u7EB3\u5143\u7D20\u7684\u6570\u91CF
     * <span class="token keyword">@param</span>   <span class="token parameter">minCapacity</span>   \u6240\u9700\u7684\u6700\u5C0F\u5BB9\u91CF
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ensureCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5982\u679C\u662Ftrue\uFF0CminExpand\u7684\u503C\u4E3A0\uFF0C\u5982\u679C\u662Ffalse,minExpand\u7684\u503C\u4E3A10</span>
        <span class="token keyword">int</span> minExpand <span class="token operator">=</span> <span class="token punctuation">(</span>elementData <span class="token operator">!=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span>
            <span class="token comment">// any size if not default element table</span>
            <span class="token operator">?</span> <span class="token number">0</span>
            <span class="token comment">// larger than default for default empty table. It&#39;s already</span>
            <span class="token comment">// supposed to be at default size.</span>
            <span class="token operator">:</span> DEFAULT_CAPACITY<span class="token punctuation">;</span>
        <span class="token comment">//\u5982\u679C\u6700\u5C0F\u5BB9\u91CF\u5927\u4E8E\u5DF2\u6709\u7684\u6700\u5927\u5BB9\u91CF</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&gt;</span> minExpand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   <span class="token comment">//1.\u5F97\u5230\u6700\u5C0F\u6269\u5BB9\u91CF</span>
   <span class="token comment">//2.\u901A\u8FC7\u6700\u5C0F\u5BB9\u91CF\u6269\u5BB9</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData <span class="token operator">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// \u83B7\u53D6\u201C\u9ED8\u8BA4\u7684\u5BB9\u91CF\u201D\u548C\u201C\u4F20\u5165\u53C2\u6570\u201D\u4E24\u8005\u4E4B\u95F4\u7684\u6700\u5927\u503C</span>
            minCapacity <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>DEFAULT_CAPACITY<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token comment">//\u5224\u65AD\u662F\u5426\u9700\u8981\u6269\u5BB9</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// overflow-conscious code</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">-</span> elementData<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token comment">//\u8C03\u7528grow\u65B9\u6CD5\u8FDB\u884C\u6269\u5BB9\uFF0C\u8C03\u7528\u6B64\u65B9\u6CD5\u4EE3\u8868\u5DF2\u7ECF\u5F00\u59CB\u6269\u5BB9\u4E86</span>
            <span class="token function">grow</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8981\u5206\u914D\u7684\u6700\u5927\u6570\u7EC4\u5927\u5C0F
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_ARRAY_SIZE <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ArrayList\u6269\u5BB9\u7684\u6838\u5FC3\u65B9\u6CD5\u3002
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// oldCapacity\u4E3A\u65E7\u5BB9\u91CF\uFF0CnewCapacity\u4E3A\u65B0\u5BB9\u91CF</span>
        <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">//\u5C06oldCapacity \u53F3\u79FB\u4E00\u4F4D\uFF0C\u5176\u6548\u679C\u76F8\u5F53\u4E8EoldCapacity /2\uFF0C</span>
        <span class="token comment">//\u6211\u4EEC\u77E5\u9053\u4F4D\u8FD0\u7B97\u7684\u901F\u5EA6\u8FDC\u8FDC\u5FEB\u4E8E\u6574\u9664\u8FD0\u7B97\uFF0C\u6574\u53E5\u8FD0\u7B97\u5F0F\u7684\u7ED3\u679C\u5C31\u662F\u5C06\u65B0\u5BB9\u91CF\u66F4\u65B0\u4E3A\u65E7\u5BB9\u91CF\u76841.5\u500D\uFF0C</span>
        <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u7136\u540E\u68C0\u67E5\u65B0\u5BB9\u91CF\u662F\u5426\u5927\u4E8E\u6700\u5C0F\u9700\u8981\u5BB9\u91CF\uFF0C\u82E5\u8FD8\u662F\u5C0F\u4E8E\u6700\u5C0F\u9700\u8981\u5BB9\u91CF\uFF0C\u90A3\u4E48\u5C31\u628A\u6700\u5C0F\u9700\u8981\u5BB9\u91CF\u5F53\u4F5C\u6570\u7EC4\u7684\u65B0\u5BB9\u91CF\uFF0C</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>
        <span class="token comment">//\u518D\u68C0\u67E5\u65B0\u5BB9\u91CF\u662F\u5426\u8D85\u51FA\u4E86ArrayList\u6240\u5B9A\u4E49\u7684\u6700\u5927\u5BB9\u91CF\uFF0C</span>
        <span class="token comment">//\u82E5\u8D85\u51FA\u4E86\uFF0C\u5219\u8C03\u7528hugeCapacity()\u6765\u6BD4\u8F83minCapacity\u548C MAX_ARRAY_SIZE\uFF0C</span>
        <span class="token comment">//\u5982\u679CminCapacity\u5927\u4E8EMAX_ARRAY_SIZE\uFF0C\u5219\u65B0\u5BB9\u91CF\u5219\u4E3AInterger.MAX_VALUE\uFF0C\u5426\u5219\uFF0C\u65B0\u5BB9\u91CF\u5927\u5C0F\u5219\u4E3A MAX_ARRAY_SIZE\u3002</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> MAX_ARRAY_SIZE <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            newCapacity <span class="token operator">=</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// minCapacity is usually close to size, so this is a win:</span>
        elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//\u6BD4\u8F83minCapacity\u548C MAX_ARRAY_SIZE</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// overflow</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OutOfMemoryError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&gt;</span> MAX_ARRAY_SIZE<span class="token punctuation">)</span> <span class="token operator">?</span>
            <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">:</span>
            MAX_ARRAY_SIZE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *\u8FD4\u56DE\u6B64\u5217\u8868\u4E2D\u7684\u5143\u7D20\u6570\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> size<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5982\u679C\u6B64\u5217\u8868\u4E0D\u5305\u542B\u5143\u7D20\uFF0C\u5219\u8FD4\u56DE true \u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u6CE8\u610F=\u548C==\u7684\u533A\u522B</span>
        <span class="token keyword">return</span> size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5982\u679C\u6B64\u5217\u8868\u5305\u542B\u6307\u5B9A\u7684\u5143\u7D20\uFF0C\u5219\u8FD4\u56DEtrue \u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//indexOf()\u65B9\u6CD5\uFF1A\u8FD4\u56DE\u6B64\u5217\u8868\u4E2D\u6307\u5B9A\u5143\u7D20\u7684\u9996\u6B21\u51FA\u73B0\u7684\u7D22\u5F15\uFF0C\u5982\u679C\u6B64\u5217\u8868\u4E0D\u5305\u542B\u6B64\u5143\u7D20\uFF0C\u5219\u4E3A-1</span>
        <span class="token keyword">return</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *\u8FD4\u56DE\u6B64\u5217\u8868\u4E2D\u6307\u5B9A\u5143\u7D20\u7684\u9996\u6B21\u51FA\u73B0\u7684\u7D22\u5F15\uFF0C\u5982\u679C\u6B64\u5217\u8868\u4E0D\u5305\u542B\u6B64\u5143\u7D20\uFF0C\u5219\u4E3A-1
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token comment">//equals()\u65B9\u6CD5\u6BD4\u8F83</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8FD4\u56DE\u6B64\u5217\u8868\u4E2D\u6307\u5B9A\u5143\u7D20\u7684\u6700\u540E\u4E00\u6B21\u51FA\u73B0\u7684\u7D22\u5F15\uFF0C\u5982\u679C\u6B64\u5217\u8868\u4E0D\u5305\u542B\u5143\u7D20\uFF0C\u5219\u8FD4\u56DE-1\u3002.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8FD4\u56DE\u6B64ArrayList\u5B9E\u4F8B\u7684\u6D45\u62F7\u8D1D\u3002 \uFF08\u5143\u7D20\u672C\u8EAB\u4E0D\u88AB\u590D\u5236\u3002\uFF09
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//Arrays.copyOf\u529F\u80FD\u662F\u5B9E\u73B0\u6570\u7EC4\u7684\u590D\u5236\uFF0C\u8FD4\u56DE\u590D\u5236\u540E\u7684\u6570\u7EC4\u3002\u53C2\u6570\u662F\u88AB\u590D\u5236\u7684\u6570\u7EC4\u548C\u590D\u5236\u7684\u957F\u5EA6</span>
            v<span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
            v<span class="token punctuation">.</span>modCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> v<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CloneNotSupportedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u8FD9\u4E0D\u5E94\u8BE5\u53D1\u751F\uFF0C\u56E0\u4E3A\u6211\u4EEC\u662F\u53EF\u4EE5\u514B\u9686\u7684</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *\u4EE5\u6B63\u786E\u7684\u987A\u5E8F\uFF08\u4ECE\u7B2C\u4E00\u4E2A\u5230\u6700\u540E\u4E00\u4E2A\u5143\u7D20\uFF09\u8FD4\u56DE\u4E00\u4E2A\u5305\u542B\u6B64\u5217\u8868\u4E2D\u6240\u6709\u5143\u7D20\u7684\u6570\u7EC4\u3002
     *\u8FD4\u56DE\u7684\u6570\u7EC4\u5C06\u662F\u201C\u5B89\u5168\u7684\u201D\uFF0C\u56E0\u4E3A\u8BE5\u5217\u8868\u4E0D\u4FDD\u7559\u5BF9\u5B83\u7684\u5F15\u7528\u3002 \uFF08\u6362\u53E5\u8BDD\u8BF4\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u5FC5\u987B\u5206\u914D\u4E00\u4E2A\u65B0\u7684\u6570\u7EC4\uFF09\u3002
     *\u56E0\u6B64\uFF0C\u8C03\u7528\u8005\u53EF\u4EE5\u81EA\u7531\u5730\u4FEE\u6539\u8FD4\u56DE\u7684\u6570\u7EC4\u3002 \u6B64\u65B9\u6CD5\u5145\u5F53\u57FA\u4E8E\u9635\u5217\u548C\u57FA\u4E8E\u96C6\u5408\u7684API\u4E4B\u95F4\u7684\u6865\u6881\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4EE5\u6B63\u786E\u7684\u987A\u5E8F\u8FD4\u56DE\u4E00\u4E2A\u5305\u542B\u6B64\u5217\u8868\u4E2D\u6240\u6709\u5143\u7D20\u7684\u6570\u7EC4\uFF08\u4ECE\u7B2C\u4E00\u4E2A\u5230\u6700\u540E\u4E00\u4E2A\u5143\u7D20\uFF09;
     *\u8FD4\u56DE\u7684\u6570\u7EC4\u7684\u8FD0\u884C\u65F6\u7C7B\u578B\u662F\u6307\u5B9A\u6570\u7EC4\u7684\u8FD0\u884C\u65F6\u7C7B\u578B\u3002 \u5982\u679C\u5217\u8868\u9002\u5408\u6307\u5B9A\u7684\u6570\u7EC4\uFF0C\u5219\u8FD4\u56DE\u5176\u4E2D\u3002
     *\u5426\u5219\uFF0C\u5C06\u4E3A\u6307\u5B9A\u6570\u7EC4\u7684\u8FD0\u884C\u65F6\u7C7B\u578B\u548C\u6B64\u5217\u8868\u7684\u5927\u5C0F\u5206\u914D\u4E00\u4E2A\u65B0\u6570\u7EC4\u3002
     *\u5982\u679C\u5217\u8868\u9002\u7528\u4E8E\u6307\u5B9A\u7684\u6570\u7EC4\uFF0C\u5176\u4F59\u7A7A\u95F4\uFF08\u5373\u6570\u7EC4\u7684\u5217\u8868\u6570\u91CF\u591A\u4E8E\u6B64\u5143\u7D20\uFF09\uFF0C\u5219\u7D27\u8DDF\u5728\u96C6\u5408\u7ED3\u675F\u540E\u7684\u6570\u7EC4\u4E2D\u7684\u5143\u7D20\u8BBE\u7F6E\u4E3Anull \u3002
     *\uFF08\u8FD9\u4EC5\u5728\u8C03\u7528\u8005\u77E5\u9053\u5217\u8868\u4E0D\u5305\u542B\u4EFB\u4F55\u7A7A\u5143\u7D20\u7684\u60C5\u51B5\u4E0B\u624D\u80FD\u786E\u5B9A\u5217\u8868\u7684\u957F\u5EA6\u3002\uFF09
     */</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">toArray</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> size<span class="token punctuation">)</span>
            <span class="token comment">// \u65B0\u5EFA\u4E00\u4E2A\u8FD0\u884C\u65F6\u7C7B\u578B\u7684\u6570\u7EC4\uFF0C\u4F46\u662FArrayList\u6570\u7EC4\u7684\u5185\u5BB9</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u8C03\u7528System\u63D0\u4F9B\u7684arraycopy()\u65B9\u6CD5\u5B9E\u73B0\u6570\u7EC4\u4E4B\u95F4\u7684\u590D\u5236</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> size<span class="token punctuation">)</span>
            a<span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Positional Access Operations</span>

    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">E</span> <span class="token function">elementData</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span> elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8FD4\u56DE\u6B64\u5217\u8868\u4E2D\u6307\u5B9A\u4F4D\u7F6E\u7684\u5143\u7D20\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u7528\u6307\u5B9A\u7684\u5143\u7D20\u66FF\u6362\u6B64\u5217\u8868\u4E2D\u6307\u5B9A\u4F4D\u7F6E\u7684\u5143\u7D20\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5BF9index\u8FDB\u884C\u754C\u9650\u68C0\u67E5</span>
        <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">E</span> oldValue <span class="token operator">=</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
        <span class="token comment">//\u8FD4\u56DE\u539F\u6765\u5728\u8FD9\u4E2A\u4F4D\u7F6E\u7684\u5143\u7D20</span>
        <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5C06\u6307\u5B9A\u7684\u5143\u7D20\u8FFD\u52A0\u5230\u6B64\u5217\u8868\u7684\u672B\u5C3E\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount!!</span>
        <span class="token comment">//\u8FD9\u91CC\u770B\u5230ArrayList\u6DFB\u52A0\u5143\u7D20\u7684\u5B9E\u8D28\u5C31\u76F8\u5F53\u4E8E\u4E3A\u6570\u7EC4\u8D4B\u503C</span>
        elementData<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5728\u6B64\u5217\u8868\u4E2D\u7684\u6307\u5B9A\u4F4D\u7F6E\u63D2\u5165\u6307\u5B9A\u7684\u5143\u7D20\u3002
     *\u5148\u8C03\u7528 rangeCheckForAdd \u5BF9index\u8FDB\u884C\u754C\u9650\u68C0\u67E5\uFF1B\u7136\u540E\u8C03\u7528 ensureCapacityInternal \u65B9\u6CD5\u4FDD\u8BC1capacity\u8DB3\u591F\u5927\uFF1B
     *\u518D\u5C06\u4ECEindex\u5F00\u59CB\u4E4B\u540E\u7684\u6240\u6709\u6210\u5458\u540E\u79FB\u4E00\u4E2A\u4F4D\u7F6E\uFF1B\u5C06element\u63D2\u5165index\u4F4D\u7F6E\uFF1B\u6700\u540Esize\u52A01\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rangeCheckForAdd</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount!!</span>
        <span class="token comment">//arraycopy()\u8FD9\u4E2A\u5B9E\u73B0\u6570\u7EC4\u4E4B\u95F4\u590D\u5236\u7684\u65B9\u6CD5\u4E00\u5B9A\u8981\u770B\u4E00\u4E0B\uFF0C\u4E0B\u9762\u5C31\u7528\u5230\u4E86arraycopy()\u65B9\u6CD5\u5B9E\u73B0\u6570\u7EC4\u81EA\u5DF1\u590D\u5236\u81EA\u5DF1</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
                         size <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
        size<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5220\u9664\u8BE5\u5217\u8868\u4E2D\u6307\u5B9A\u4F4D\u7F6E\u7684\u5143\u7D20\u3002 \u5C06\u4EFB\u4F55\u540E\u7EED\u5143\u7D20\u79FB\u52A8\u5230\u5DE6\u4FA7\uFF08\u4ECE\u5176\u7D22\u5F15\u4E2D\u51CF\u53BB\u4E00\u4E2A\u5143\u7D20\uFF09\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token class-name">E</span> oldValue <span class="token operator">=</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span>
                             numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// clear to let GC do its work</span>
      <span class="token comment">//\u4ECE\u5217\u8868\u4E2D\u5220\u9664\u7684\u5143\u7D20</span>
        <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4ECE\u5217\u8868\u4E2D\u5220\u9664\u6307\u5B9A\u5143\u7D20\u7684\u7B2C\u4E00\u4E2A\u51FA\u73B0\uFF08\u5982\u679C\u5B58\u5728\uFF09\u3002 \u5982\u679C\u5217\u8868\u4E0D\u5305\u542B\u8BE5\u5143\u7D20\uFF0C\u5219\u5B83\u4E0D\u4F1A\u66F4\u6539\u3002
     *\u8FD4\u56DEtrue\uFF0C\u5982\u679C\u6B64\u5217\u8868\u5305\u542B\u6307\u5B9A\u7684\u5143\u7D20
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">fastRemove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">fastRemove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
     * Private remove method that skips bounds checking and does not
     * return the value removed.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">fastRemove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span>
                             numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// clear to let GC do its work</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4ECE\u5217\u8868\u4E2D\u5220\u9664\u6240\u6709\u5143\u7D20\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// \u628A\u6570\u7EC4\u4E2D\u6240\u6709\u7684\u5143\u7D20\u7684\u503C\u8BBE\u4E3Anull</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u6309\u6307\u5B9A\u96C6\u5408\u7684Iterator\u8FD4\u56DE\u7684\u987A\u5E8F\u5C06\u6307\u5B9A\u96C6\u5408\u4E2D\u7684\u6240\u6709\u5143\u7D20\u8FFD\u52A0\u5230\u6B64\u5217\u8868\u7684\u672B\u5C3E\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> numNew <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> numNew<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> numNew<span class="token punctuation">)</span><span class="token punctuation">;</span>
        size <span class="token operator">+=</span> numNew<span class="token punctuation">;</span>
        <span class="token keyword">return</span> numNew <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5C06\u6307\u5B9A\u96C6\u5408\u4E2D\u7684\u6240\u6709\u5143\u7D20\u63D2\u5165\u5230\u6B64\u5217\u8868\u4E2D\uFF0C\u4ECE\u6307\u5B9A\u7684\u4F4D\u7F6E\u5F00\u59CB\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">addAll</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rangeCheckForAdd</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> numNew <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> numNew<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount</span>

        <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index <span class="token operator">+</span> numNew<span class="token punctuation">,</span>
                             numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> numNew<span class="token punctuation">)</span><span class="token punctuation">;</span>
        size <span class="token operator">+=</span> numNew<span class="token punctuation">;</span>
        <span class="token keyword">return</span> numNew <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4ECE\u6B64\u5217\u8868\u4E2D\u5220\u9664\u6240\u6709\u7D22\u5F15\u4E3AfromIndex \uFF08\u542B\uFF09\u548CtoIndex\u4E4B\u95F4\u7684\u5143\u7D20\u3002
     *\u5C06\u4EFB\u4F55\u540E\u7EED\u5143\u7D20\u79FB\u52A8\u5230\u5DE6\u4FA7\uFF08\u51CF\u5C11\u5176\u7D22\u5F15\uFF09\u3002
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">removeRange</span><span class="token punctuation">(</span><span class="token keyword">int</span> fromIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> toIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> toIndex<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> toIndex<span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> fromIndex<span class="token punctuation">,</span>
                         numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// clear to let GC do its work</span>
        <span class="token keyword">int</span> newSize <span class="token operator">=</span> size <span class="token operator">-</span> <span class="token punctuation">(</span>toIndex<span class="token operator">-</span>fromIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> newSize<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        size <span class="token operator">=</span> newSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u68C0\u67E5\u7ED9\u5B9A\u7684\u7D22\u5F15\u662F\u5426\u5728\u8303\u56F4\u5185\u3002
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">rangeCheck</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> size<span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token function">outOfBoundsMsg</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * add\u548CaddAll\u4F7F\u7528\u7684rangeCheck\u7684\u4E00\u4E2A\u7248\u672C
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">rangeCheckForAdd</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> size <span class="token operator">||</span> index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token function">outOfBoundsMsg</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8FD4\u56DEIndexOutOfBoundsException\u7EC6\u8282\u4FE1\u606F
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">outOfBoundsMsg</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Index: &quot;</span><span class="token operator">+</span>index<span class="token operator">+</span><span class="token string">&quot;, Size: &quot;</span><span class="token operator">+</span>size<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4ECE\u6B64\u5217\u8868\u4E2D\u5220\u9664\u6307\u5B9A\u96C6\u5408\u4E2D\u5305\u542B\u7684\u6240\u6709\u5143\u7D20\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">removeAll</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5982\u679C\u6B64\u5217\u8868\u88AB\u4FEE\u6539\u5219\u8FD4\u56DEtrue</span>
        <span class="token keyword">return</span> <span class="token function">batchRemove</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u4EC5\u4FDD\u7559\u6B64\u5217\u8868\u4E2D\u5305\u542B\u5728\u6307\u5B9A\u96C6\u5408\u4E2D\u7684\u5143\u7D20\u3002
     *\u6362\u53E5\u8BDD\u8BF4\uFF0C\u4ECE\u6B64\u5217\u8868\u4E2D\u5220\u9664\u5176\u4E2D\u4E0D\u5305\u542B\u5728\u6307\u5B9A\u96C6\u5408\u4E2D\u7684\u6240\u6709\u5143\u7D20\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">retainAll</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">batchRemove</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * \u4ECE\u5217\u8868\u4E2D\u7684\u6307\u5B9A\u4F4D\u7F6E\u5F00\u59CB\uFF0C\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u5143\u7D20\uFF08\u6309\u6B63\u786E\u987A\u5E8F\uFF09\u7684\u5217\u8868\u8FED\u4EE3\u5668\u3002
     *\u6307\u5B9A\u7684\u7D22\u5F15\u8868\u793A\u521D\u59CB\u8C03\u7528\u5C06\u8FD4\u56DE\u7684\u7B2C\u4E00\u4E2A\u5143\u7D20\u4E3Anext \u3002 \u521D\u59CB\u8C03\u7528previous\u5C06\u8FD4\u56DE\u6307\u5B9A\u7D22\u5F15\u51CF1\u7684\u5143\u7D20\u3002
     *\u8FD4\u56DE\u7684\u5217\u8868\u8FED\u4EE3\u5668\u662Ffail-fast \u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ListIterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token function">listIterator</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;</span> size<span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token string">&quot;Index: &quot;</span><span class="token operator">+</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ListItr</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *\u8FD4\u56DE\u5217\u8868\u4E2D\u7684\u5217\u8868\u8FED\u4EE3\u5668\uFF08\u6309\u9002\u5F53\u7684\u987A\u5E8F\uFF09\u3002
     *\u8FD4\u56DE\u7684\u5217\u8868\u8FED\u4EE3\u5668\u662Ffail-fast \u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ListIterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token function">listIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ListItr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *\u4EE5\u6B63\u786E\u7684\u987A\u5E8F\u8FD4\u56DE\u8BE5\u5217\u8868\u4E2D\u7684\u5143\u7D20\u7684\u8FED\u4EE3\u5668\u3002
     *\u8FD4\u56DE\u7684\u8FED\u4EE3\u5668\u662Ffail-fast \u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Itr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-arraylist-\u6269\u5BB9\u673A\u5236\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_3-arraylist-\u6269\u5BB9\u673A\u5236\u5206\u6790" aria-hidden="true">#</a> 3. ArrayList \u6269\u5BB9\u673A\u5236\u5206\u6790</h2><h3 id="_3-1-\u5148\u4ECE-arraylist-\u7684\u6784\u9020\u51FD\u6570\u8BF4\u8D77" tabindex="-1"><a class="header-anchor" href="#_3-1-\u5148\u4ECE-arraylist-\u7684\u6784\u9020\u51FD\u6570\u8BF4\u8D77" aria-hidden="true">#</a> 3.1. \u5148\u4ECE ArrayList \u7684\u6784\u9020\u51FD\u6570\u8BF4\u8D77</h3><p><strong>\uFF08JDK8\uFF09ArrayList \u6709\u4E09\u79CD\u65B9\u5F0F\u6765\u521D\u59CB\u5316\uFF0C\u6784\u9020\u65B9\u6CD5\u6E90\u7801\u5982\u4E0B\uFF1A</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token doc-comment comment">/**
     * \u9ED8\u8BA4\u521D\u59CB\u5BB9\u91CF\u5927\u5C0F
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_CAPACITY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>


    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     *\u9ED8\u8BA4\u6784\u9020\u51FD\u6570\uFF0C\u4F7F\u7528\u521D\u59CB\u5BB9\u91CF10\u6784\u9020\u4E00\u4E2A\u7A7A\u5217\u8868(\u65E0\u53C2\u6570\u6784\u9020)
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5E26\u521D\u59CB\u5BB9\u91CF\u53C2\u6570\u7684\u6784\u9020\u51FD\u6570\u3002\uFF08\u7528\u6237\u81EA\u5DF1\u6307\u5B9A\u5BB9\u91CF\uFF09
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//\u521D\u59CB\u5BB9\u91CF\u5927\u4E8E0</span>
            <span class="token comment">//\u521B\u5EFAinitialCapacity\u5927\u5C0F\u7684\u6570\u7EC4</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>initialCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//\u521D\u59CB\u5BB9\u91CF\u7B49\u4E8E0</span>
            <span class="token comment">//\u521B\u5EFA\u7A7A\u6570\u7EC4</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//\u521D\u59CB\u5BB9\u91CF\u5C0F\u4E8E0\uFF0C\u629B\u51FA\u5F02\u5E38</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Illegal Capacity: &quot;</span><span class="token operator">+</span>
                                               initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


   <span class="token doc-comment comment">/**
    *\u6784\u9020\u5305\u542B\u6307\u5B9Acollection\u5143\u7D20\u7684\u5217\u8868\uFF0C\u8FD9\u4E9B\u5143\u7D20\u5229\u7528\u8BE5\u96C6\u5408\u7684\u8FED\u4EE3\u5668\u6309\u987A\u5E8F\u8FD4\u56DE
    *\u5982\u679C\u6307\u5B9A\u7684\u96C6\u5408\u4E3Anull\uFF0Cthrows NullPointerException\u3002
    */</span>
     <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        elementData <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// replace with empty array.</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7EC6\u5FC3\u7684\u540C\u5B66\u4E00\u5B9A\u4F1A\u53D1\u73B0 \uFF1A<strong>\u4EE5\u65E0\u53C2\u6570\u6784\u9020\u65B9\u6CD5\u521B\u5EFA <code>ArrayList</code> \u65F6\uFF0C\u5B9E\u9645\u4E0A\u521D\u59CB\u5316\u8D4B\u503C\u7684\u662F\u4E00\u4E2A\u7A7A\u6570\u7EC4\u3002\u5F53\u771F\u6B63\u5BF9\u6570\u7EC4\u8FDB\u884C\u6DFB\u52A0\u5143\u7D20\u64CD\u4F5C\u65F6\uFF0C\u624D\u771F\u6B63\u5206\u914D\u5BB9\u91CF\u3002\u5373\u5411\u6570\u7EC4\u4E2D\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u5143\u7D20\u65F6\uFF0C\u6570\u7EC4\u5BB9\u91CF\u6269\u4E3A 10\u3002</strong> \u4E0B\u9762\u5728\u6211\u4EEC\u5206\u6790 ArrayList \u6269\u5BB9\u65F6\u4F1A\u8BB2\u5230\u8FD9\u4E00\u70B9\u5185\u5BB9\uFF01</p><blockquote><p>\u8865\u5145\uFF1AJDK6 new \u65E0\u53C2\u6784\u9020\u7684 <code>ArrayList</code> \u5BF9\u8C61\u65F6\uFF0C\u76F4\u63A5\u521B\u5EFA\u4E86\u957F\u5EA6\u662F 10 \u7684 <code>Object[]</code> \u6570\u7EC4 elementData \u3002</p></blockquote><h3 id="_3-2-\u4E00\u6B65\u4E00\u6B65\u5206\u6790-arraylist-\u6269\u5BB9\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#_3-2-\u4E00\u6B65\u4E00\u6B65\u5206\u6790-arraylist-\u6269\u5BB9\u673A\u5236" aria-hidden="true">#</a> 3.2. \u4E00\u6B65\u4E00\u6B65\u5206\u6790 ArrayList \u6269\u5BB9\u673A\u5236</h3><p>\u8FD9\u91CC\u4EE5\u65E0\u53C2\u6784\u9020\u51FD\u6570\u521B\u5EFA\u7684 ArrayList \u4E3A\u4F8B\u5206\u6790</p><h4 id="_3-2-1-\u5148\u6765\u770B-add-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-2-1-\u5148\u6765\u770B-add-\u65B9\u6CD5" aria-hidden="true">#</a> 3.2.1. \u5148\u6765\u770B <code>add</code> \u65B9\u6CD5</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * \u5C06\u6307\u5B9A\u7684\u5143\u7D20\u8FFD\u52A0\u5230\u6B64\u5217\u8868\u7684\u672B\u5C3E\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//\u6DFB\u52A0\u5143\u7D20\u4E4B\u524D\uFF0C\u5148\u8C03\u7528ensureCapacityInternal\u65B9\u6CD5</span>
        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount!!</span>
        <span class="token comment">//\u8FD9\u91CC\u770B\u5230ArrayList\u6DFB\u52A0\u5143\u7D20\u7684\u5B9E\u8D28\u5C31\u76F8\u5F53\u4E8E\u4E3A\u6570\u7EC4\u8D4B\u503C</span>
        elementData<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u6CE8\u610F</strong> \uFF1AJDK11 \u79FB\u9664\u4E86 <code>ensureCapacityInternal()</code> \u548C <code>ensureExplicitCapacity()</code> \u65B9\u6CD5</p></blockquote><h4 id="_3-2-2-\u518D\u6765\u770B\u770B-ensurecapacityinternal-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-2-2-\u518D\u6765\u770B\u770B-ensurecapacityinternal-\u65B9\u6CD5" aria-hidden="true">#</a> 3.2.2. \u518D\u6765\u770B\u770B <code>ensureCapacityInternal()</code> \u65B9\u6CD5</h4><p>\uFF08JDK7\uFF09\u53EF\u4EE5\u770B\u5230 <code>add</code> \u65B9\u6CD5 \u9996\u5148\u8C03\u7528\u4E86<code>ensureCapacityInternal(size + 1)</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">//\u5F97\u5230\u6700\u5C0F\u6269\u5BB9\u91CF</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData <span class="token operator">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// \u83B7\u53D6\u9ED8\u8BA4\u7684\u5BB9\u91CF\u548C\u4F20\u5165\u53C2\u6570\u7684\u8F83\u5927\u503C</span>
            minCapacity <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>DEFAULT_CAPACITY<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5F53 \u8981 add \u8FDB\u7B2C 1 \u4E2A\u5143\u7D20\u65F6\uFF0CminCapacity \u4E3A 1\uFF0C\u5728 Math.max()\u65B9\u6CD5\u6BD4\u8F83\u540E\uFF0CminCapacity \u4E3A 10\u3002</strong></p><blockquote><p>\u6B64\u5904\u548C\u540E\u7EED JDK8 \u4EE3\u7801\u683C\u5F0F\u5316\u7565\u6709\u4E0D\u540C\uFF0C\u6838\u5FC3\u4EE3\u7801\u57FA\u672C\u4E00\u6837\u3002</p></blockquote><h4 id="_3-2-3-ensureexplicitcapacity-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-2-3-ensureexplicitcapacity-\u65B9\u6CD5" aria-hidden="true">#</a> 3.2.3. <code>ensureExplicitCapacity()</code> \u65B9\u6CD5</h4><p>\u5982\u679C\u8C03\u7528 <code>ensureCapacityInternal()</code> \u65B9\u6CD5\u5C31\u4E00\u5B9A\u4F1A\u8FDB\u5165\uFF08\u6267\u884C\uFF09\u8FD9\u4E2A\u65B9\u6CD5\uFF0C\u4E0B\u9762\u6211\u4EEC\u6765\u7814\u7A76\u4E00\u4E0B\u8FD9\u4E2A\u65B9\u6CD5\u7684\u6E90\u7801\uFF01</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">//\u5224\u65AD\u662F\u5426\u9700\u8981\u6269\u5BB9</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token comment">// overflow-conscious code</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">-</span> elementData<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token comment">//\u8C03\u7528grow\u65B9\u6CD5\u8FDB\u884C\u6269\u5BB9\uFF0C\u8C03\u7528\u6B64\u65B9\u6CD5\u4EE3\u8868\u5DF2\u7ECF\u5F00\u59CB\u6269\u5BB9\u4E86</span>
            <span class="token function">grow</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u6765\u4ED4\u7EC6\u5206\u6790\u4E00\u4E0B\uFF1A</p><ul><li>\u5F53\u6211\u4EEC\u8981 add \u8FDB\u7B2C 1 \u4E2A\u5143\u7D20\u5230 ArrayList \u65F6\uFF0CelementData.length \u4E3A 0 \uFF08\u56E0\u4E3A\u8FD8\u662F\u4E00\u4E2A\u7A7A\u7684 list\uFF09\uFF0C\u56E0\u4E3A\u6267\u884C\u4E86 <code>ensureCapacityInternal()</code> \u65B9\u6CD5 \uFF0C\u6240\u4EE5 minCapacity \u6B64\u65F6\u4E3A 10\u3002\u6B64\u65F6\uFF0C<code>minCapacity - elementData.length &gt; 0</code>\u6210\u7ACB\uFF0C\u6240\u4EE5\u4F1A\u8FDB\u5165 <code>grow(minCapacity)</code> \u65B9\u6CD5\u3002</li><li>\u5F53 add \u7B2C 2 \u4E2A\u5143\u7D20\u65F6\uFF0CminCapacity \u4E3A 2\uFF0C\u6B64\u65F6 e lementData.length(\u5BB9\u91CF)\u5728\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u5143\u7D20\u540E\u6269\u5BB9\u6210 10 \u4E86\u3002\u6B64\u65F6\uFF0C<code>minCapacity - elementData.length &gt; 0</code> \u4E0D\u6210\u7ACB\uFF0C\u6240\u4EE5\u4E0D\u4F1A\u8FDB\u5165 \uFF08\u6267\u884C\uFF09<code>grow(minCapacity)</code> \u65B9\u6CD5\u3002</li><li>\u6DFB\u52A0\u7B2C 3\u30014\xB7\xB7\xB7\u5230\u7B2C 10 \u4E2A\u5143\u7D20\u65F6\uFF0C\u4F9D\u7136\u4E0D\u4F1A\u6267\u884C grow \u65B9\u6CD5\uFF0C\u6570\u7EC4\u5BB9\u91CF\u90FD\u4E3A 10\u3002</li></ul><p>\u76F4\u5230\u6DFB\u52A0\u7B2C 11 \u4E2A\u5143\u7D20\uFF0CminCapacity(\u4E3A 11)\u6BD4 elementData.length\uFF08\u4E3A 10\uFF09\u8981\u5927\u3002\u8FDB\u5165 grow \u65B9\u6CD5\u8FDB\u884C\u6269\u5BB9\u3002</p><h4 id="_3-2-4-grow-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-2-4-grow-\u65B9\u6CD5" aria-hidden="true">#</a> 3.2.4. <code>grow()</code> \u65B9\u6CD5</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * \u8981\u5206\u914D\u7684\u6700\u5927\u6570\u7EC4\u5927\u5C0F
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_ARRAY_SIZE <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ArrayList\u6269\u5BB9\u7684\u6838\u5FC3\u65B9\u6CD5\u3002
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// oldCapacity\u4E3A\u65E7\u5BB9\u91CF\uFF0CnewCapacity\u4E3A\u65B0\u5BB9\u91CF</span>
        <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">//\u5C06oldCapacity \u53F3\u79FB\u4E00\u4F4D\uFF0C\u5176\u6548\u679C\u76F8\u5F53\u4E8EoldCapacity /2\uFF0C</span>
        <span class="token comment">//\u6211\u4EEC\u77E5\u9053\u4F4D\u8FD0\u7B97\u7684\u901F\u5EA6\u8FDC\u8FDC\u5FEB\u4E8E\u6574\u9664\u8FD0\u7B97\uFF0C\u6574\u53E5\u8FD0\u7B97\u5F0F\u7684\u7ED3\u679C\u5C31\u662F\u5C06\u65B0\u5BB9\u91CF\u66F4\u65B0\u4E3A\u65E7\u5BB9\u91CF\u76841.5\u500D\uFF0C</span>
        <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u7136\u540E\u68C0\u67E5\u65B0\u5BB9\u91CF\u662F\u5426\u5927\u4E8E\u6700\u5C0F\u9700\u8981\u5BB9\u91CF\uFF0C\u82E5\u8FD8\u662F\u5C0F\u4E8E\u6700\u5C0F\u9700\u8981\u5BB9\u91CF\uFF0C\u90A3\u4E48\u5C31\u628A\u6700\u5C0F\u9700\u8981\u5BB9\u91CF\u5F53\u4F5C\u6570\u7EC4\u7684\u65B0\u5BB9\u91CF\uFF0C</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>
       <span class="token comment">// \u5982\u679C\u65B0\u5BB9\u91CF\u5927\u4E8E MAX_ARRAY_SIZE,\u8FDB\u5165(\u6267\u884C) \`hugeCapacity()\` \u65B9\u6CD5\u6765\u6BD4\u8F83 minCapacity \u548C MAX_ARRAY_SIZE\uFF0C</span>
       <span class="token comment">//\u5982\u679CminCapacity\u5927\u4E8E\u6700\u5927\u5BB9\u91CF\uFF0C\u5219\u65B0\u5BB9\u91CF\u5219\u4E3A\`Integer.MAX_VALUE\`\uFF0C\u5426\u5219\uFF0C\u65B0\u5BB9\u91CF\u5927\u5C0F\u5219\u4E3A MAX_ARRAY_SIZE \u5373\u4E3A \`Integer.MAX_VALUE - 8\`\u3002</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> MAX_ARRAY_SIZE <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            newCapacity <span class="token operator">=</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// minCapacity is usually close to size, so this is a win:</span>
        elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1),\u6240\u4EE5 ArrayList \u6BCF\u6B21\u6269\u5BB9\u4E4B\u540E\u5BB9\u91CF\u90FD\u4F1A\u53D8\u4E3A\u539F\u6765\u7684 1.5 \u500D\u5DE6\u53F3\uFF08oldCapacity \u4E3A\u5076\u6570\u5C31\u662F 1.5 \u500D\uFF0C\u5426\u5219\u662F 1.5 \u500D\u5DE6\u53F3\uFF09\uFF01</strong> \u5947\u5076\u4E0D\u540C\uFF0C\u6BD4\u5982 \uFF1A10+10/2 = 15, 33+33/2=49\u3002\u5982\u679C\u662F\u5947\u6570\u7684\u8BDD\u4F1A\u4E22\u6389\u5C0F\u6570.</p><blockquote><p>&quot;&gt;&gt;&quot;\uFF08\u79FB\u4F4D\u8FD0\u7B97\u7B26\uFF09\uFF1A&gt;&gt;1 \u53F3\u79FB\u4E00\u4F4D\u76F8\u5F53\u4E8E\u9664 2\uFF0C\u53F3\u79FB n \u4F4D\u76F8\u5F53\u4E8E\u9664\u4EE5 2 \u7684 n \u6B21\u65B9\u3002\u8FD9\u91CC oldCapacity \u660E\u663E\u53F3\u79FB\u4E86 1 \u4F4D\u6240\u4EE5\u76F8\u5F53\u4E8E oldCapacity /2\u3002\u5BF9\u4E8E\u5927\u6570\u636E\u7684 2 \u8FDB\u5236\u8FD0\u7B97,\u4F4D\u79FB\u8FD0\u7B97\u7B26\u6BD4\u90A3\u4E9B\u666E\u901A\u8FD0\u7B97\u7B26\u7684\u8FD0\u7B97\u8981\u5FEB\u5F88\u591A,\u56E0\u4E3A\u7A0B\u5E8F\u4EC5\u4EC5\u79FB\u52A8\u4E00\u4E0B\u800C\u5DF2,\u4E0D\u53BB\u8BA1\u7B97,\u8FD9\u6837\u63D0\u9AD8\u4E86\u6548\u7387,\u8282\u7701\u4E86\u8D44\u6E90</p></blockquote><p><strong>\u6211\u4EEC\u518D\u6765\u901A\u8FC7\u4F8B\u5B50\u63A2\u7A76\u4E00\u4E0B<code>grow()</code> \u65B9\u6CD5 \uFF1A</strong></p><ul><li>\u5F53 add \u7B2C 1 \u4E2A\u5143\u7D20\u65F6\uFF0ColdCapacity \u4E3A 0\uFF0C\u7ECF\u6BD4\u8F83\u540E\u7B2C\u4E00\u4E2A if \u5224\u65AD\u6210\u7ACB\uFF0CnewCapacity = minCapacity(\u4E3A 10)\u3002\u4F46\u662F\u7B2C\u4E8C\u4E2A if \u5224\u65AD\u4E0D\u4F1A\u6210\u7ACB\uFF0C\u5373 newCapacity \u4E0D\u6BD4 MAX_ARRAY_SIZE \u5927\uFF0C\u5219\u4E0D\u4F1A\u8FDB\u5165 <code>hugeCapacity</code> \u65B9\u6CD5\u3002\u6570\u7EC4\u5BB9\u91CF\u4E3A 10\uFF0Cadd \u65B9\u6CD5\u4E2D return true,size \u589E\u4E3A 1\u3002</li><li>\u5F53 add \u7B2C 11 \u4E2A\u5143\u7D20\u8FDB\u5165 grow \u65B9\u6CD5\u65F6\uFF0CnewCapacity \u4E3A 15\uFF0C\u6BD4 minCapacity\uFF08\u4E3A 11\uFF09\u5927\uFF0C\u7B2C\u4E00\u4E2A if \u5224\u65AD\u4E0D\u6210\u7ACB\u3002\u65B0\u5BB9\u91CF\u6CA1\u6709\u5927\u4E8E\u6570\u7EC4\u6700\u5927 size\uFF0C\u4E0D\u4F1A\u8FDB\u5165 hugeCapacity \u65B9\u6CD5\u3002\u6570\u7EC4\u5BB9\u91CF\u6269\u4E3A 15\uFF0Cadd \u65B9\u6CD5\u4E2D return true,size \u589E\u4E3A 11\u3002</li><li>\u4EE5\u6B64\u7C7B\u63A8\xB7\xB7\xB7\xB7\xB7\xB7</li></ul><p><strong>\u8FD9\u91CC\u8865\u5145\u4E00\u70B9\u6BD4\u8F83\u91CD\u8981\uFF0C\u4F46\u662F\u5BB9\u6613\u88AB\u5FFD\u89C6\u6389\u7684\u77E5\u8BC6\u70B9\uFF1A</strong></p><ul><li>java \u4E2D\u7684 <code>length</code>\u5C5E\u6027\u662F\u9488\u5BF9\u6570\u7EC4\u8BF4\u7684,\u6BD4\u5982\u8BF4\u4F60\u58F0\u660E\u4E86\u4E00\u4E2A\u6570\u7EC4,\u60F3\u77E5\u9053\u8FD9\u4E2A\u6570\u7EC4\u7684\u957F\u5EA6\u5219\u7528\u5230\u4E86 length \u8FD9\u4E2A\u5C5E\u6027.</li><li>java \u4E2D\u7684 <code>length()</code> \u65B9\u6CD5\u662F\u9488\u5BF9\u5B57\u7B26\u4E32\u8BF4\u7684,\u5982\u679C\u60F3\u770B\u8FD9\u4E2A\u5B57\u7B26\u4E32\u7684\u957F\u5EA6\u5219\u7528\u5230 <code>length()</code> \u8FD9\u4E2A\u65B9\u6CD5.</li><li>java \u4E2D\u7684 <code>size()</code> \u65B9\u6CD5\u662F\u9488\u5BF9\u6CDB\u578B\u96C6\u5408\u8BF4\u7684,\u5982\u679C\u60F3\u770B\u8FD9\u4E2A\u6CDB\u578B\u6709\u591A\u5C11\u4E2A\u5143\u7D20,\u5C31\u8C03\u7528\u6B64\u65B9\u6CD5\u6765\u67E5\u770B!</li></ul><h4 id="_3-2-5-hugecapacity-\u65B9\u6CD5\u3002" tabindex="-1"><a class="header-anchor" href="#_3-2-5-hugecapacity-\u65B9\u6CD5\u3002" aria-hidden="true">#</a> 3.2.5. <code>hugeCapacity()</code> \u65B9\u6CD5\u3002</h4><p>\u4ECE\u4E0A\u9762 <code>grow()</code> \u65B9\u6CD5\u6E90\u7801\u6211\u4EEC\u77E5\u9053\uFF1A \u5982\u679C\u65B0\u5BB9\u91CF\u5927\u4E8E MAX_ARRAY_SIZE,\u8FDB\u5165(\u6267\u884C) <code>hugeCapacity()</code> \u65B9\u6CD5\u6765\u6BD4\u8F83 minCapacity \u548C MAX_ARRAY_SIZE\uFF0C\u5982\u679C minCapacity \u5927\u4E8E\u6700\u5927\u5BB9\u91CF\uFF0C\u5219\u65B0\u5BB9\u91CF\u5219\u4E3A<code>Integer.MAX_VALUE</code>\uFF0C\u5426\u5219\uFF0C\u65B0\u5BB9\u91CF\u5927\u5C0F\u5219\u4E3A MAX_ARRAY_SIZE \u5373\u4E3A <code>Integer.MAX_VALUE - 8</code>\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// overflow</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OutOfMemoryError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5BF9minCapacity\u548CMAX_ARRAY_SIZE\u8FDB\u884C\u6BD4\u8F83</span>
        <span class="token comment">//\u82E5minCapacity\u5927\uFF0C\u5C06Integer.MAX_VALUE\u4F5C\u4E3A\u65B0\u6570\u7EC4\u7684\u5927\u5C0F</span>
        <span class="token comment">//\u82E5MAX_ARRAY_SIZE\u5927\uFF0C\u5C06MAX_ARRAY_SIZE\u4F5C\u4E3A\u65B0\u6570\u7EC4\u7684\u5927\u5C0F</span>
        <span class="token comment">//MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&gt;</span> MAX_ARRAY_SIZE<span class="token punctuation">)</span> <span class="token operator">?</span>
            <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">:</span>
            MAX_ARRAY_SIZE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-system-arraycopy-\u548C-arrays-copyof-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-3-system-arraycopy-\u548C-arrays-copyof-\u65B9\u6CD5" aria-hidden="true">#</a> 3.3. <code>System.arraycopy()</code> \u548C <code>Arrays.copyOf()</code>\u65B9\u6CD5</h3><p>\u9605\u8BFB\u6E90\u7801\u7684\u8BDD\uFF0C\u6211\u4EEC\u5C31\u4F1A\u53D1\u73B0 ArrayList \u4E2D\u5927\u91CF\u8C03\u7528\u4E86\u8FD9\u4E24\u4E2A\u65B9\u6CD5\u3002\u6BD4\u5982\uFF1A\u6211\u4EEC\u4E0A\u9762\u8BB2\u7684\u6269\u5BB9\u64CD\u4F5C\u4EE5\u53CA<code>add(int index, E element)</code>\u3001<code>toArray()</code> \u7B49\u65B9\u6CD5\u4E2D\u90FD\u7528\u5230\u4E86\u8BE5\u65B9\u6CD5\uFF01</p><h4 id="_3-3-1-system-arraycopy-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-3-1-system-arraycopy-\u65B9\u6CD5" aria-hidden="true">#</a> 3.3.1. <code>System.arraycopy()</code> \u65B9\u6CD5</h4><p>\u6E90\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token comment">// \u6211\u4EEC\u53D1\u73B0 arraycopy \u662F\u4E00\u4E2A native \u65B9\u6CD5,\u63A5\u4E0B\u6765\u6211\u4EEC\u89E3\u91CA\u4E00\u4E0B\u5404\u4E2A\u53C2\u6570\u7684\u5177\u4F53\u610F\u4E49</span>
    <span class="token doc-comment comment">/**
    *   \u590D\u5236\u6570\u7EC4
    * <span class="token keyword">@param</span> <span class="token parameter">src</span> \u6E90\u6570\u7EC4
    * <span class="token keyword">@param</span> <span class="token parameter">srcPos</span> \u6E90\u6570\u7EC4\u4E2D\u7684\u8D77\u59CB\u4F4D\u7F6E
    * <span class="token keyword">@param</span> <span class="token parameter">dest</span> \u76EE\u6807\u6570\u7EC4
    * <span class="token keyword">@param</span> <span class="token parameter">destPos</span> \u76EE\u6807\u6570\u7EC4\u4E2D\u7684\u8D77\u59CB\u4F4D\u7F6E
    * <span class="token keyword">@param</span> <span class="token parameter">length</span> \u8981\u590D\u5236\u7684\u6570\u7EC4\u5143\u7D20\u7684\u6570\u91CF
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">arraycopy</span><span class="token punctuation">(</span><span class="token class-name">Object</span> src<span class="token punctuation">,</span>  <span class="token keyword">int</span>  srcPos<span class="token punctuation">,</span>
                                        <span class="token class-name">Object</span> dest<span class="token punctuation">,</span> <span class="token keyword">int</span> destPos<span class="token punctuation">,</span>
                                        <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u573A\u666F\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * \u5728\u6B64\u5217\u8868\u4E2D\u7684\u6307\u5B9A\u4F4D\u7F6E\u63D2\u5165\u6307\u5B9A\u7684\u5143\u7D20\u3002
     *\u5148\u8C03\u7528 rangeCheckForAdd \u5BF9index\u8FDB\u884C\u754C\u9650\u68C0\u67E5\uFF1B\u7136\u540E\u8C03\u7528 ensureCapacityInternal \u65B9\u6CD5\u4FDD\u8BC1capacity\u8DB3\u591F\u5927\uFF1B
     *\u518D\u5C06\u4ECEindex\u5F00\u59CB\u4E4B\u540E\u7684\u6240\u6709\u6210\u5458\u540E\u79FB\u4E00\u4E2A\u4F4D\u7F6E\uFF1B\u5C06element\u63D2\u5165index\u4F4D\u7F6E\uFF1B\u6700\u540Esize\u52A01\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rangeCheckForAdd</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount!!</span>
        <span class="token comment">//arraycopy()\u65B9\u6CD5\u5B9E\u73B0\u6570\u7EC4\u81EA\u5DF1\u590D\u5236\u81EA\u5DF1</span>
        <span class="token comment">//elementData:\u6E90\u6570\u7EC4;index:\u6E90\u6570\u7EC4\u4E2D\u7684\u8D77\u59CB\u4F4D\u7F6E;elementData\uFF1A\u76EE\u6807\u6570\u7EC4\uFF1Bindex + 1\uFF1A\u76EE\u6807\u6570\u7EC4\u4E2D\u7684\u8D77\u59CB\u4F4D\u7F6E\uFF1B size - index\uFF1A\u8981\u590D\u5236\u7684\u6570\u7EC4\u5143\u7D20\u7684\u6570\u91CF\uFF1B</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> size <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
        size<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u5199\u4E00\u4E2A\u7B80\u5355\u7684\u65B9\u6CD5\u6D4B\u8BD5\u4EE5\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArraycopyTest</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// TODO Auto-generated method stub</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">99</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ED3\u679C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>0 1 99 2 3 0 0 0 0 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-3-2-arrays-copyof-\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-3-2-arrays-copyof-\u65B9\u6CD5" aria-hidden="true">#</a> 3.3.2. <code>Arrays.copyOf()</code>\u65B9\u6CD5</h4><p>\u6E90\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">copyOf</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> original<span class="token punctuation">,</span> <span class="token keyword">int</span> newLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token comment">// \u7533\u8BF7\u4E00\u4E2A\u65B0\u7684\u6570\u7EC4</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> copy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>newLength<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">// \u8C03\u7528System.arraycopy,\u5C06\u6E90\u6570\u7EC4\u4E2D\u7684\u6570\u636E\u8FDB\u884C\u62F7\u8D1D,\u5E76\u8FD4\u56DE\u65B0\u7684\u6570\u7EC4</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>original<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> copy<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
                         <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>original<span class="token punctuation">.</span>length<span class="token punctuation">,</span> newLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> copy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u573A\u666F\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token doc-comment comment">/**
     \u4EE5\u6B63\u786E\u7684\u987A\u5E8F\u8FD4\u56DE\u4E00\u4E2A\u5305\u542B\u6B64\u5217\u8868\u4E2D\u6240\u6709\u5143\u7D20\u7684\u6570\u7EC4\uFF08\u4ECE\u7B2C\u4E00\u4E2A\u5230\u6700\u540E\u4E00\u4E2A\u5143\u7D20\uFF09; \u8FD4\u56DE\u7684\u6570\u7EC4\u7684\u8FD0\u884C\u65F6\u7C7B\u578B\u662F\u6307\u5B9A\u6570\u7EC4\u7684\u8FD0\u884C\u65F6\u7C7B\u578B\u3002
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//elementData\uFF1A\u8981\u590D\u5236\u7684\u6570\u7EC4\uFF1Bsize\uFF1A\u8981\u590D\u5236\u7684\u957F\u5EA6</span>
        <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E2A\u4EBA\u89C9\u5F97\u4F7F\u7528 <code>Arrays.copyOf()</code>\u65B9\u6CD5\u4E3B\u8981\u662F\u4E3A\u4E86\u7ED9\u539F\u6709\u6570\u7EC4\u6269\u5BB9\uFF0C\u6D4B\u8BD5\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayscopyOfTest</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;b.length&quot;</span><span class="token operator">+</span>b<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ED3\u679C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>10
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-3-3-\u4E24\u8005\u8054\u7CFB\u548C\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_3-3-3-\u4E24\u8005\u8054\u7CFB\u548C\u533A\u522B" aria-hidden="true">#</a> 3.3.3. \u4E24\u8005\u8054\u7CFB\u548C\u533A\u522B</h4><p><strong>\u8054\u7CFB\uFF1A</strong></p><p>\u770B\u4E24\u8005\u6E90\u4EE3\u7801\u53EF\u4EE5\u53D1\u73B0 <code>copyOf()</code>\u5185\u90E8\u5B9E\u9645\u8C03\u7528\u4E86 <code>System.arraycopy()</code> \u65B9\u6CD5</p><p><strong>\u533A\u522B\uFF1A</strong></p><p><code>arraycopy()</code> \u9700\u8981\u76EE\u6807\u6570\u7EC4\uFF0C\u5C06\u539F\u6570\u7EC4\u62F7\u8D1D\u5230\u4F60\u81EA\u5DF1\u5B9A\u4E49\u7684\u6570\u7EC4\u91CC\u6216\u8005\u539F\u6570\u7EC4\uFF0C\u800C\u4E14\u53EF\u4EE5\u9009\u62E9\u62F7\u8D1D\u7684\u8D77\u70B9\u548C\u957F\u5EA6\u4EE5\u53CA\u653E\u5165\u65B0\u6570\u7EC4\u4E2D\u7684\u4F4D\u7F6E <code>copyOf()</code> \u662F\u7CFB\u7EDF\u81EA\u52A8\u5728\u5185\u90E8\u65B0\u5EFA\u4E00\u4E2A\u6570\u7EC4\uFF0C\u5E76\u8FD4\u56DE\u8BE5\u6570\u7EC4\u3002</p><h3 id="_3-4-ensurecapacity\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_3-4-ensurecapacity\u65B9\u6CD5" aria-hidden="true">#</a> 3.4. <code>ensureCapacity</code>\u65B9\u6CD5</h3><p>ArrayList \u6E90\u7801\u4E2D\u6709\u4E00\u4E2A <code>ensureCapacity</code> \u65B9\u6CD5\u4E0D\u77E5\u9053\u5927\u5BB6\u6CE8\u610F\u5230\u6CA1\u6709\uFF0C\u8FD9\u4E2A\u65B9\u6CD5 ArrayList \u5185\u90E8\u6CA1\u6709\u88AB\u8C03\u7528\u8FC7\uFF0C\u6240\u4EE5\u5F88\u663E\u7136\u662F\u63D0\u4F9B\u7ED9\u7528\u6237\u8C03\u7528\u7684\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u65B9\u6CD5\u6709\u4EC0\u4E48\u4F5C\u7528\u5462\uFF1F</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
    \u5982\u6709\u5FC5\u8981\uFF0C\u589E\u52A0\u6B64 ArrayList \u5B9E\u4F8B\u7684\u5BB9\u91CF\uFF0C\u4EE5\u786E\u4FDD\u5B83\u81F3\u5C11\u53EF\u4EE5\u5BB9\u7EB3\u7531minimum capacity\u53C2\u6570\u6307\u5B9A\u7684\u5143\u7D20\u6570\u3002
     *
     * <span class="token keyword">@param</span>   <span class="token parameter">minCapacity</span>   \u6240\u9700\u7684\u6700\u5C0F\u5BB9\u91CF
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ensureCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> minExpand <span class="token operator">=</span> <span class="token punctuation">(</span>elementData <span class="token operator">!=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span>
            <span class="token comment">// any size if not default element table</span>
            <span class="token operator">?</span> <span class="token number">0</span>
            <span class="token comment">// larger than default for default empty table. It&#39;s already</span>
            <span class="token comment">// supposed to be at default size.</span>
            <span class="token operator">:</span> DEFAULT_CAPACITY<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&gt;</span> minExpand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6700\u597D\u5728 add \u5927\u91CF\u5143\u7D20\u4E4B\u524D\u7528 <code>ensureCapacity</code> \u65B9\u6CD5\uFF0C\u4EE5\u51CF\u5C11\u589E\u91CF\u91CD\u65B0\u5206\u914D\u7684\u6B21\u6570</strong></p><p>\u6211\u4EEC\u901A\u8FC7\u4E0B\u9762\u7684\u4EE3\u7801\u5B9E\u9645\u6D4B\u8BD5\u4EE5\u4E0B\u8FD9\u4E2A\u65B9\u6CD5\u7684\u6548\u679C\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnsureCapacityTest</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token class-name">N</span> <span class="token operator">=</span> <span class="token number">10000000</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u4F7F\u7528ensureCapacity\u65B9\u6CD5\u524D\uFF1A&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime <span class="token operator">-</span> startTime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u4F7F\u7528ensureCapacity\u65B9\u6CD5\u524D\uFF1A2158
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnsureCapacityTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token class-name">N</span> <span class="token operator">=</span> <span class="token number">10000000</span><span class="token punctuation">;</span>
        list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> startTime1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">ensureCapacity</span><span class="token punctuation">(</span><span class="token class-name">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> endTime1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u4F7F\u7528ensureCapacity\u65B9\u6CD5\u540E\uFF1A&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime1 <span class="token operator">-</span> startTime1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u4F7F\u7528ensureCapacity\u65B9\u6CD5\u540E\uFF1A1773
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u901A\u8FC7\u8FD0\u884C\u7ED3\u679C\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u51FA\u5411 ArrayList \u6DFB\u52A0\u5927\u91CF\u5143\u7D20\u4E4B\u524D\u6700\u597D\u5148\u4F7F\u7528<code>ensureCapacity</code> \u65B9\u6CD5\uFF0C\u4EE5\u51CF\u5C11\u589E\u91CF\u91CD\u65B0\u5206\u914D\u7684\u6B21\u6570\u3002</p>`,81),c=[p];function o(i,l){return s(),a("div",null,c)}var r=n(t,[["render",o],["__file","arraylist-source-code.html.vue"]]);export{r as default};
